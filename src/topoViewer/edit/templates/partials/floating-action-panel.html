<!-- Floating Action Button with Radial Menu -->
<div id="floating-action-panel" class="fixed bottom-4 left-4 z-50">
  <!-- Main FAB button -->
  <div id="fab-container" class="relative">
    <!-- Radial menu items (hidden by default) -->
    <div id="radial-menu" class="absolute opacity-0 pointer-events-none transition-all duration-300">
      <!-- Add Node button -->
      <button id="radial-add-node" 
              class="radial-menu-item absolute w-12 h-12 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-lg transition-all duration-300 flex items-center justify-center"
              title="Add Node">
        <i class="fas fa-server"></i>
      </button>
      
      <!-- Add Group button -->
      <button id="radial-add-group" 
              class="radial-menu-item absolute w-12 h-12 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-lg transition-all duration-300 flex items-center justify-center"
              title="Add Group">
        <i class="fas fa-object-group"></i>
      </button>
      
      <!-- Add Text button -->
      <button id="radial-add-text" 
              class="radial-menu-item absolute w-12 h-12 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-lg transition-all duration-300 flex items-center justify-center"
              title="Add Text">
        <i class="fas fa-font"></i>
      </button>
    </div>
    
    <!-- Main + button -->
    <button id="fab-main" 
            class="w-14 h-14 rounded-full bg-[var(--vscode-button-background)] hover:bg-[var(--vscode-button-hoverBackground)] text-[var(--vscode-button-foreground)] shadow-xl transition-all duration-300 flex items-center justify-center relative z-10"
            data-is-lab-deployed="{{isLabDeployed}}">
      <i id="fab-main-icon" class="fas fa-plus text-xl transition-transform duration-300"></i>
    </button>
  </div>
</div>

<style>
  #floating-action-panel {
    /* Ensure it stays above other elements but below modals */
    z-index: 40;
  }
  
  #fab-main {
    /* Add subtle animation on hover and state changes */
    transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s ease;
  }
  
  #fab-main:hover:not(.active) {
    transform: scale(1.05);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
  }
  
  #fab-main.active {
    transform: rotate(45deg) scale(1.1);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
  }
  
  #fab-main.active:hover {
    transform: rotate(45deg) scale(1.15);
  }
  
  /* Radial menu positioning when active */
  #radial-menu.active {
    opacity: 1;
    pointer-events: auto;
  }
  
  /* Initial state for radial items - collapsed at center */
  .radial-menu-item {
    transform: translate(0, 0) scale(0);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  
  /* Position radial menu items in a 90-degree arc when active */
  /* 80px radius, positioned at 0°, 45°, and 90° from positive x-axis */
  #radial-menu.active #radial-add-node {
    transform: translate(80px, 0px) scale(1); /* 0° - rightward */
    opacity: 1;
    transition-delay: 0.05s;
  }
  
  #radial-menu.active #radial-add-group {
    transform: translate(56px, -56px) scale(1); /* 45° - diagonal up-right */
    opacity: 1;
    transition-delay: 0.1s;
  }
  
  #radial-menu.active #radial-add-text {
    transform: translate(0px, -80px) scale(1); /* 90° - upward */
    opacity: 1;
    transition-delay: 0.15s;
  }
  
  /* VS Code theme integration */
  #floating-action-panel button {
    border: 1px solid var(--vscode-button-border, transparent);
  }
  
  /* Subtle pulse animation for main button when idle */
  @keyframes gentlePulse {
    0%, 100% {
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    50% {
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
    }
  }
  
  #fab-main:not(.active):not(:hover) {
    animation: gentlePulse 3s infinite ease-in-out;
  }
  
  /* Locked state for deployed labs */
  #fab-main[data-is-lab-deployed="true"] {
    background-color: #dc2626 !important; /* red-600 */
    pointer-events: none;
    cursor: not-allowed;
    animation: none !important; /* Disable pulse when locked */
  }
  
  #fab-main[data-is-lab-deployed="true"]:hover {
    background-color: #b91c1c !important; /* red-700 */
    transform: none !important; /* Disable hover transform when locked */
  }
</style>